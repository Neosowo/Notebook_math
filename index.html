<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, shrink-to-fit=no">
    <title>Notebook Math</title>
    <link rel="stylesheet" href="assets/css/main.css">
    <meta name="description" content="Notebook Math: Apuntes, ejemplos y teoría matemática en un solo lugar.">
    <meta name="keywords" content="matemáticas, apuntes, teoría, ejemplos, notebook, educación, álgebra, cálculo, matematicas, math, notes">
    <meta name="author" content="Neosowo">
    <!-- Favicon -->
    <link rel="icon" type="image/png" href="assets/img/icon_gradient.png">
    <link href="https://cdn.jsdelivr.net/npm/tailwindcss@2.2.19/dist/tailwind.min.css" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&family=Fira+Code:wght@400;500&family=Outfit:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <!-- Open Graph / Facebook -->
    <meta property="og:title" content="Notebook Math">
    <meta property="og:description" content="Notebook Math: Apuntes, ejemplos y teoría matemática en un solo lugar.">
    <meta property="og:image" content="https://neosowo.github.io/Notebook_math/assets/img/icon_gradient.png">
    <meta property="og:url" content="https://neosowo.github.io/Notebook_math/">
    <meta property="og:type" content="website">
    <!-- Twitter Card -->
    <meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:title" content="Notebook Math">
    <meta name="twitter:description" content="Notebook Math: Apuntes, ejemplos y teoría matemática en un solo lugar.">
    <meta name="twitter:image" content="https://neosowo.github.io/Notebook_math/assets/img/icon_gradient.png">
    <!-- Theme color para navegadores móviles -->
    <meta name="theme-color" content="#0D1117">
    <!-- Canonical URL -->
    <link rel="canonical" href="https://neosowo.github.io/Notebook_math/">
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        primary: '#5B7BF0',
                        secondary: '#8C5EF7',
                        accent: '#FF7979',
                        dark: '#1F2937',
                    },
                }
            }
        }
    </script>
</head>
<body class="bg-gray-50 font-sans flex flex-col min-h-screen touch-device overflow-fix">
    <div class="flex flex-grow">
        <!-- Sidebar -->
        <aside id="notebook_math_title" class="sidebar fixed lg:sticky lg:top-0 lg:h-screen inset-y-0 left-0 w-72 shadow-lg z-50 transform -translate-x-full lg:translate-x-0 transition-transform duration-300 ease-in-out overflow-y-auto">
            <div class="sticky top-0 sidebar-header z-10 py-3 px-4 flex justify-between items-center">
                <h2 class="text-lg font-bold flex items-center" >
                    <img src="assets/img/icon_gradient.png" alt="Logo" class="w-6 h-6 mr-2">
                    Notebook Math
                </h2>
                
                <button class="sidebar-close p-2 rounded-lg hover:bg-opacity-10 hover:bg-white lg:hidden">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            
            <nav class="py-4" id="sidebar-nav">
                <!-- El contenido de la navegación se cargará desde el JSON -->
                <div class="loading-container">
                    <div class="loading-spinner"></div>
                </div>
            </nav>
        </aside>
        
        <div class="sidebar-overlay fixed inset-0 bg-black bg-opacity-50 z-40 hidden lg:hidden"></div>
        
        <main class="flex-grow overflow-fix">
            <header class="border-b sticky top-0 z-30 backdrop-blur-md" style="background-color: var(--header-bg);">
                <div class="flex items-center justify-between px-4 py-3">
                    <div class="flex items-center">
                        <button class="sidebar-toggle mr-3 p-2 rounded-lg hover:bg-gray-100 lg:hidden">
                            <i class="fas fa-bars"></i>
                        </button>
                        <h1 class="text-xl font-bold flex items-center" id="main-title">
                            <img src="assets/img/icon_white.png" alt="Logo" class="w-7 h-7 mr-2">
                            <span>Cargando...</span>
                        </h1>
                    </div>
                    
                    <div class="flex items-center space-x-2">
                        <!-- Botón de edición eliminado -->
                    </div>
                </div>
            </header>
            
            <div class="p-4 lg:p-6 flex flex-col lg:flex-row overflow-fix">
                <div class="w-full lg:w-full lg:pr-6 overflow-fix" id="main-content">
                    <!-- El contenido principal se cargará desde el JSON -->
                    <div class="loading-container">
                        <div class="loading-spinner"></div>
                    </div>
                </div>
                
                <!-- Tabla de Contenidos (Escritorio) -->
                <div class="w-full lg:w-1/4 mt-8 lg:mt-0 lg:ml-6 toc-container">
                    <div class="toc-wrapper rounded-lg p-4 shadow-aesthetic">
                        <h3 class="font-medium mb-3 flex items-center" style="color: var(--text-color);">
                            <i class="fas fa-list-ul text-accent mr-2"></i>
                            En esta página
                        </h3>
                        <div class="toc-content" id="toc-desktop">
                            <!-- La tabla de contenidos se generará automáticamente -->
                        </div>
                    </div>
                </div>
            </div>
        </main>
    </div>
                
    <!-- Botón de volver arriba -->
    <button id="back-to-top" class="fixed bottom-5 right-5 p-3 rounded-full shadow-md hover:shadow-lg focus:outline-none z-20 transform translate-y-20 opacity-0 transition-all duration-300 btn-gradient text-white">
        <i class="fas fa-arrow-up"></i>
    </button>
    
    <!-- TOC Móvil -->
    <div id="mobile-toc" class="fixed inset-x-0 bottom-0 z-40 shadow-lg rounded-t-xl transform translate-y-full transition-transform duration-300 ease-in-out" style="background-color: var(--card-bg); color: var(--text-color);">
        <div class="flex justify-between items-center px-4 py-3 border-b">
            <h3 class="font-medium flex items-center" style="color: var(--text-color);">
                <i class="fas fa-list-ul text-accent mr-2"></i>
                En esta página
            </h3>
            <button class="toc-close p-2 rounded-lg hover:bg-gray-100">
                <i class="fas fa-times"></i>
            </button>
        </div>
        <div class="p-4 max-h-96 overflow-y-auto">
            <!-- La tabla de contenidos móvil se generará automáticamente -->
        </div>
    </div>
    
    <!-- Botón de TOC Móvil -->
    <button id="toc-mobile-toggle" class="fixed bottom-5 left-5 p-3 rounded-full shadow-md hover:shadow-lg focus:outline-none z-20 lg:hidden" style="background-color: var(--card-bg); color: var(--text-color);">
        <i class="fas fa-list-ul"></i>
    </button>
    
    <!-- Overlay para TOC Móvil -->
    <div id="toc-overlay" class="fixed inset-0 bg-black bg-opacity-50 z-30 hidden lg:hidden"></div>
    
    <!-- Scripts -->
    <script src="assets/js/sidebar-scroll.js"></script>
    <script src="assets/js/sticky-scroll.js"></script>
    <script>
    document.addEventListener('DOMContentLoaded', function() {
        // Referencias a elementos del DOM
        const sidebarToggle = document.querySelector('.sidebar-toggle');
        const sidebar = document.querySelector('aside');
        const sidebarClose = document.querySelector('.sidebar-close');
        const sidebarOverlay = document.querySelector('.sidebar-overlay');
        const backToTopBtn = document.getElementById('back-to-top');
        const mobileToc = document.getElementById('mobile-toc');
        const tocMobileToggle = document.getElementById('toc-mobile-toggle');
        const tocOverlay = document.getElementById('toc-overlay');
        const tocClose = document.querySelector('.toc-close');
        const mainContent = document.getElementById('main-content');
        const sidebarNav = document.getElementById('sidebar-nav');
        const mainTitle = document.getElementById('main-title');
        const tocDesktop = document.getElementById('toc-desktop');
        
        // Detectar si es un dispositivo táctil
        const isTouchDevice = () => {
            return 'ontouchstart' in window || navigator.maxTouchPoints > 0 || navigator.msMaxTouchPoints > 0;
        };
        
        // Aplicar clase para dispositivos táctiles
        if (isTouchDevice()) {
            document.body.classList.add('touch-device');
        }
        
        // Prevenir zoom en dispositivos móviles
        document.addEventListener('touchstart', function(e) {
            if (e.touches.length > 1) {
                e.preventDefault();
            }
        }, { passive: false });
        
        // Detectar orientación y ajustar la interfaz
        const updateOrientation = () => {
            const isPortrait = window.innerHeight > window.innerWidth;
            document.body.classList.toggle('portrait', isPortrait);
            document.body.classList.toggle('landscape', !isPortrait);
        };
        
        // Inicializar orientación
        updateOrientation();
        
        // Escuchar cambios de orientación
        window.addEventListener('resize', updateOrientation);
        window.addEventListener('orientationchange', updateOrientation);

        // Función para cargar el contenido desde JSON
        async function loadContentFromJSON() {
            try {
                console.log('Intentando cargar el archivo JSON...');
                
                // Intentar cargar el archivo JSON
                const response = await fetch('content.json');
                
                if (!response.ok) {
                    console.error('Error HTTP:', response.status, response.statusText);
                    throw new Error(`Error HTTP: ${response.status}`);
                }
                
                console.log('Archivo JSON encontrado, procesando...');
                const data = await response.json();
                
                // Renderizar el título principal
                mainTitle.innerHTML = `<span class="js-title">${data.title}</span>`;
                document.title = data.title + ' - Notebook';
                
                // Limpiar contenedores
                mainContent.innerHTML = '';
                sidebarNav.innerHTML = '';
                
                // Renderizar secciones
                data.sections.forEach(section => {
                    renderSection(section, mainContent);
                    
                    // Agregar al sidebar
                    const sidebarLink = document.createElement('a');
                    sidebarLink.href = `#`;
                    sidebarLink.setAttribute('data-section-id', section.id);
                    sidebarLink.className = 'sidebar-link';
                    sidebarLink.textContent = section.title;
                    sidebarLink.setAttribute('data-scroll-top', 'true');
                    sidebarNav.appendChild(sidebarLink);
                });
                
                // Mostrar solo la primera sección por defecto (proposiciones)
                if (data.sections.length > 0) {
                    const firstSectionId = data.sections[0].id;
                    updateTableOfContents(firstSectionId);
                    
                    // También resaltar el primer enlace del sidebar como activo
                    const firstSidebarLink = sidebarNav.querySelector('.sidebar-link');
                    if (firstSidebarLink) {
                        firstSidebarLink.classList.add('active');
                    }
                }
                
                // Configurar eventos del sidebar
                setupSidebarEvents();
                
                // Activar funcionalidades
                activateCopyButtons();
                
            } catch (error) {
                console.error('Error al cargar el contenido:', error);
                
                // Mensaje de error más descriptivo
                mainContent.innerHTML = `
                    <div class="bg-red-50 border-l-4 border-red-500 p-4 rounded-r">
                        <div class="flex items-center mb-2">
                            <i class="fas fa-exclamation-circle text-red-500 mr-2"></i>
                            <span class="font-semibold">Error al cargar el contenido</span>
                        </div>
                        <p class="text-gray-700 mb-4">
                            No se pudo cargar el archivo content.json. Esto puede deberse a varias razones:
                        </p>
                        <ul class="list-disc ml-6 mb-4 text-gray-700">
                            <li class="mb-2">El archivo no existe en la ubicación correcta</li>
                            <li class="mb-2">Estás accediendo al sitio directamente desde el sistema de archivos (file://) en lugar de usar un servidor web</li>
                            <li class="mb-2">El archivo JSON contiene errores de sintaxis</li>
                        </ul>
                        <p class="text-gray-700 mb-2"><strong>Solución:</strong></p>
                        <ol class="list-decimal ml-6 text-gray-700">
                            <li class="mb-2">Verifica que content.json existe en la misma carpeta que index.html</li>
                            <li class="mb-2">Accede a la página a través de un servidor web como XAMPP (http://localhost/tu-proyecto/)</li>
                            <li class="mb-2">Valida el JSON en un validador como jsonlint.com</li>
                        </ol>
                        <p class="mt-4 text-sm text-gray-500">Error técnico: ${error.message}</p>
                    </div>
                `;
            }
        }
        
        // Función para renderizar una sección
        function renderSection(section, container) {
            const sectionElement = document.createElement('section');
            sectionElement.className = 'mb-10';
            
            // Título de la sección
            const title = document.createElement('h2');
            title.id = section.id;
            title.className = 'text-2xl font-bold pb-2 border-b mb-4';
            title.textContent = section.title;
            sectionElement.appendChild(title);
            
            // Contenido de la sección
            section.content.forEach(item => {
                renderContentItem(item, sectionElement);
            });
            
            container.appendChild(sectionElement);
        }
        
        // Función para renderizar un elemento de contenido
        function renderContentItem(item, container) {
    switch (item.type) {
        case 'paragraph':
            const p = document.createElement('p');
            p.className = 'mb-4 text-gray-700';
            p.innerHTML = item.text;
            container.appendChild(p);
            break;

        case 'subheading':
            const h3 = document.createElement('h3');
            h3.id = item.id;
            h3.className = 'text-xl font-semibold mt-6 mb-3';
            h3.textContent = item.title;
            container.appendChild(h3);
            break;

        case 'code':
            const codeBlock = document.createElement('div');
            codeBlock.className = 'relative bg-gray-800 text-white p-4 rounded-lg mb-6 font-mono text-sm';
            codeBlock.innerHTML = `
                <button class="copy-code absolute top-3 right-3 p-1 rounded text-gray-400 hover:text-white hover:bg-gray-700">
                    <i class="fas fa-copy"></i>
                </button>
                <pre class="overflow-x-auto"><code>${escapeHtml(item.code)}</code></pre>
            `;
            container.appendChild(codeBlock);
            break;

        case 'note':
            const note = document.createElement('div');
            note.className = 'bg-blue-50 border-l-4 border-blue-500 p-4 mb-6 rounded-r';
            note.innerHTML = `
                <div class="flex items-center mb-2">
                    <i class="fas fa-info-circle text-blue-500 mr-2"></i>
                    <span class="font-semibold">${item.title}</span>
                </div>
                <p class="text-gray-700">${item.text}</p>
            `;
            container.appendChild(note);
            break;

        case 'warning':
            const warning = document.createElement('div');
            warning.className = 'bg-yellow-50 border-l-4 border-yellow-500 p-4 mb-6 rounded-r';
            warning.innerHTML = `
                <div class="flex items-center mb-2">
                    <i class="fas fa-exclamation-triangle text-yellow-500 mr-2"></i>
                    <span class="font-semibold">${item.title}</span>
                </div>
                <p class="text-gray-700">${item.text}</p>
            `;
            container.appendChild(warning);
            break;

        case 'list':
            const ul = document.createElement('ul');
            ul.className = 'list-disc pl-6 mb-6 text-gray-700';
            item.items.forEach(listItem => {
                const li = document.createElement('li');
                li.className = 'mb-2';
                li.innerHTML = listItem;
                ul.appendChild(li);
            });
            container.appendChild(ul);
            break;

        case 'latex':
            const latexBlock = document.createElement('div');
            latexBlock.className = 'my-6 flex justify-center latex-block';
            latexBlock.innerHTML = `\\(${item.latex}\\)`;
            container.appendChild(latexBlock);
            if (window.MathJax) {
                MathJax.typesetPromise([latexBlock]);
            }
            break;

        case 'example':
            const example = document.createElement('div');
            example.className = 'border rounded-lg overflow-hidden mb-6';
            example.innerHTML = `
                <div class="bg-gray-100 font-medium px-4 py-2 border-b">${item.title}</div>
                <div class="p-4">
                    <div class="relative bg-gray-800 text-white p-4 rounded-lg font-mono text-sm">
                        <button class="copy-code absolute top-3 right-3 p-1 rounded text-gray-400 hover:text-white hover:bg-gray-700">
                            <i class="fas fa-copy"></i>
                        </button>
                        <pre class="overflow-x-auto"><code>${escapeHtml(item.code)}</code></pre>
                    </div>
                </div>
            `;
            container.appendChild(example);
            break;

        case 'table':
            const table = document.createElement('table');
            table.className = 'w-full border border-gray-300 mb-6 text-center';

            const thead = document.createElement('thead');
            const headRow = document.createElement('tr');
            item.headers.forEach(header => {
                const th = document.createElement('th');
                th.className = 'border px-4 py-2 bg-gray-100';
                th.textContent = header;
                headRow.appendChild(th);
            });
            thead.appendChild(headRow);
            table.appendChild(thead);

            const tbody = document.createElement('tbody');
            item.rows.forEach(row => {
                const tr = document.createElement('tr');
                row.forEach(cell => {
                    const td = document.createElement('td');
                    td.className = 'border px-4 py-2';
                    td.textContent = cell;
                    tr.appendChild(td);
                });
                tbody.appendChild(tr);
            });
            table.appendChild(tbody);

            container.appendChild(table);
            break;

        case 'image':
            const img = document.createElement('img');
            img.src = item.src;
            img.alt = item.alt || '';
            img.className = 'my-4 rounded-lg shadow-md';
            container.appendChild(img);
            break;

        case 'video':
            const video = document.createElement('video');
            video.src = item.src;
            video.controls = true;
            video.className = 'w-full my-4 rounded-lg shadow-md';
            container.appendChild(video);
            break;
    }
}

        
        // Función para escapar HTML
        function escapeHtml(text) {
            return text
                .replace(/&/g, "&amp;")
                .replace(/</g, "&lt;")
                .replace(/>/g, "&gt;")
                .replace(/"/g, "&quot;")
                .replace(/'/g, "&#039;");
        }
        
        // Activar botones de copiar código
        function activateCopyButtons() {
            document.querySelectorAll('.copy-code').forEach(button => {
                button.addEventListener('click', function() {
                    const code = this.closest('div').querySelector('code').textContent;
                    navigator.clipboard.writeText(code).then(() => {
                        // Cambiar ícono temporalmente
                        const icon = this.querySelector('i');
                        icon.className = 'fas fa-check';
                        setTimeout(() => {
                            icon.className = 'fas fa-copy';
                        }, 2000);
                    });
                });
            });
        }
        
        // Actualizar tabla de contenidos
        function updateTableOfContents(activeSectionId = null) {
            // Obtener todos los títulos h2 y h3
            const headings = document.querySelectorAll('h2[id], h3[id]');
            const tocContent = document.querySelector('#toc-desktop');
            const mobileTocContent = document.querySelector('#mobile-toc .p-4');
            
            if (!tocContent || !mobileTocContent) return;
            
            // Limpiar tabla de contenidos actual
            tocContent.innerHTML = '';
            mobileTocContent.innerHTML = '';
            
            // Primero, oculta todas las secciones principales que no sean la sección activa
            if (activeSectionId) {
                document.querySelectorAll('section').forEach(section => {
                    const sectionTitle = section.querySelector('h2');
                    if (sectionTitle && sectionTitle.id !== activeSectionId) {
                        section.style.display = 'none';
                    } else {
                        section.style.display = 'block';
                    }
                });
            } else {
                // Si no hay sección activa, mostrar todas
                document.querySelectorAll('section').forEach(section => {
                    section.style.display = 'block';
                });
            }
            
            let currentMainHeading = null;
            let shouldShow = !activeSectionId; // Si no hay sección activa, mostrar todo
            
            // Recrear enlaces basados en los títulos actuales
            headings.forEach(heading => {
                const id = heading.id;
                const text = heading.textContent.trim();
                const isMainHeading = heading.tagName.toLowerCase() === 'h2';
                
                // Si es un título principal (h2)
                if (isMainHeading) {
                    currentMainHeading = id;
                    shouldShow = !activeSectionId || activeSectionId === id;
                    
                    // Si es la sección activa o no hay sección activa, mostrar el enlace
                    if (!activeSectionId || activeSectionId === id) {
                // Crear enlace para TOC de escritorio
                const link = document.createElement('a');
                link.href = `#${id}`;
                        link.dataset.sectionId = id;
                        link.className = 'toc-link block py-1.5 text-gray-600 hover:text-primary border-l-2 border-transparent pl-3 hover:border-primary mb-1';
                link.textContent = text;
                tocContent.appendChild(link);
                
                // Crear enlace para TOC móvil
                const mobileLink = document.createElement('a');
                mobileLink.href = `#${id}`;
                        mobileLink.dataset.sectionId = id;
                        mobileLink.className = 'block py-2 px-3 mb-1 border-l-2 border-transparent hover:border-primary hover:bg-gray-50 rounded-r-md transition-all duration-200';
                mobileLink.textContent = text;
                mobileTocContent.appendChild(mobileLink);
                    }
                } 
                // Si es un subtítulo (h3) y está dentro de la sección activa o no hay sección activa
                else if (shouldShow) {
                    // Crear enlace para TOC de escritorio
                    const link = document.createElement('a');
                    link.href = `#${id}`;
                    link.dataset.parentSection = currentMainHeading;
                    link.className = 'toc-link block py-1.5 text-gray-600 hover:text-primary pl-6 mb-1 text-sm';
                    link.textContent = text;
                    tocContent.appendChild(link);
                    
                    // Crear enlace para TOC móvil
                    const mobileLink = document.createElement('a');
                    mobileLink.href = `#${id}`;
                    mobileLink.dataset.parentSection = currentMainHeading;
                    mobileLink.className = 'block py-2 px-3 pl-6 mb-1 border-l-2 border-transparent hover:border-primary hover:bg-gray-50 rounded-r-md transition-all duration-200 text-sm';
                    mobileLink.textContent = text;
                    mobileTocContent.appendChild(mobileLink);
                }
            });
            
            // Agregar eventos a los enlaces del TOC móvil
            document.querySelectorAll('#mobile-toc a').forEach(link => {
                link.addEventListener('click', () => {
                    if (mobileToc) {
                        mobileToc.classList.add('translate-y-full');
                        if (tocOverlay) tocOverlay.classList.add('hidden');
                    }
                });
            });

            // Ajusta el scroll para que el header no tape el título
            setupTOCScrollOffset();
        }
        
        // Ajusta el scroll para que el header no tape el título
        function setupTOCScrollOffset() {
            // Selecciona todos los enlaces del TOC (escritorio y móvil)
            document.querySelectorAll('.toc-link, #mobile-toc a').forEach(link => {
                link.addEventListener('click', function(e) {
                    // Solo si es un hash interno
                    if (this.hash) {
                        const target = document.querySelector(this.hash);
                        if (target) {
                            e.preventDefault();
                            // Altura del header (ajusta si tu header es más alto)
                            const header = document.querySelector('header');
                            const headerHeight = header ? header.offsetHeight : 0;
                            // Posición del elemento menos el header
                            const y = target.getBoundingClientRect().top + window.pageYOffset - headerHeight - 10; // -10px extra por margen
                            window.scrollTo({ top: y, behavior: 'smooth' });
                            // Opcional: actualiza el hash en la URL
                            history.replaceState(null, null, this.hash);
                        }
                    }
                });
            });
        }
        
        // Agregar eventos al sidebar después del renderizado
        function setupSidebarEvents() {
            document.querySelectorAll('.sidebar-link').forEach(link => {
                link.addEventListener('click', (e) => {
                    // Ya no es necesario prevenir el evento predeterminado aquí
                    // porque se maneja en sidebar-scroll.js
                    
                    // ID de la sección a la que corresponde el enlace
                    const sectionId = link.getAttribute('data-section-id');
                    
                    // Actualizar la tabla de contenidos para mostrar solo los subtemas de esta sección
                    updateTableOfContents(sectionId);
                    
                    // Resaltar el enlace activo del sidebar
                    document.querySelectorAll('.sidebar-link').forEach(l => l.classList.remove('active'));
                    link.classList.add('active');
                    
                    // Actualizar el título principal con el texto del enlace seleccionado
                    const mainTitleSpan = document.querySelector('#main-title span');
                    if (mainTitleSpan) {
                        mainTitleSpan.textContent = link.textContent;
                    }
                    
                    // Hacer scroll a la parte superior de la página
                    window.scrollTo({
                        top: 0,
                        behavior: 'smooth'
                    });
                });
            });
        }
        
        // Funciones de UI y eventos
        
        // Sidebar Toggle con cierre automático en clic fuera (para móviles)
        function toggleSidebar() {
            if (sidebar) {
                sidebar.classList.toggle('translate-x-0');
                sidebar.classList.toggle('-translate-x-full');
                if (sidebarOverlay) {
                    sidebarOverlay.classList.toggle('hidden');
                }
                
                // Cierra sidebar automáticamente después de clic en enlaces en móvil
                if (window.innerWidth < 1024 && sidebar.classList.contains('translate-x-0')) {
                    document.querySelectorAll('.sidebar-link').forEach(link => {
                        link.addEventListener('click', function() {
                            setTimeout(() => toggleSidebar(), 300);
                        }, { once: true });
                    });
                }
            }
        }
        
        // Evitar scroll del body cuando el sidebar o TOC están abiertos
        function manageBodyScroll() {
            const sidebarOpen = sidebar && sidebar.classList.contains('translate-x-0');
            const tocOpen = mobileToc && !mobileToc.classList.contains('translate-y-full');
            
            if ((sidebarOpen || tocOpen) && window.innerWidth < 1024) {
                document.body.style.overflow = 'hidden';
            } else {
                document.body.style.overflow = '';
            }
        }
        
        // Eventos para UI
        if (sidebarToggle) {
            sidebarToggle.addEventListener('click', function() {
                toggleSidebar();
                manageBodyScroll();
            });
        }
        
        if (sidebarClose) {
            sidebarClose.addEventListener('click', function() {
                toggleSidebar();
                manageBodyScroll();
            });
        }
        
        if (sidebarOverlay) {
            sidebarOverlay.addEventListener('click', function() {
                toggleSidebar();
                manageBodyScroll();
            });
        }
        
        // TOC móvil
        if (tocMobileToggle && mobileToc && tocOverlay) {
            tocMobileToggle.addEventListener('click', function() {
                mobileToc.classList.toggle('translate-y-full');
                tocOverlay.classList.toggle('hidden');
                manageBodyScroll();
            });
            
            if (tocClose) {
                tocClose.addEventListener('click', function() {
                    mobileToc.classList.add('translate-y-full');
                    tocOverlay.classList.add('hidden');
                    manageBodyScroll();
                });
            }
            
            tocOverlay.addEventListener('click', function() {
                mobileToc.classList.add('translate-y-full');
                tocOverlay.classList.add('hidden');
                manageBodyScroll();
            });
        }
        
        // Botón volver arriba
        if (backToTopBtn) {
            window.addEventListener('scroll', function() {
                if (window.scrollY > 300) {
                    backToTopBtn.classList.remove('translate-y-20', 'opacity-0');
                } else {
                    backToTopBtn.classList.add('translate-y-20', 'opacity-0');
                }
            });
            
            backToTopBtn.addEventListener('click', function() {
                window.scrollTo({ top: 0, behavior: 'smooth' });
            });
        }
        
        // Desactivar doble tap para zoom en dispositivos móviles
        let lastTapTime = 0;
        document.addEventListener('touchend', function(e) {
            const currentTime = new Date().getTime();
            const tapLength = currentTime - lastTapTime;
            if (tapLength < 300 && tapLength > 0) {
                e.preventDefault();
            }
            lastTapTime = currentTime;
        });
        
        // Mejorar rendimiento en scroll
        let ticking = false;
        window.addEventListener('scroll', function() {
            if (!ticking) {
                window.requestAnimationFrame(function() {
                    // Aplicar efectos basados en scroll si los hay
                    ticking = false;
                });
                ticking = true;
            }
        });
        
        // Cargar contenido al iniciar
        loadContentFromJSON();

        // Añadir el enlace de GitHub
        const headerRight = document.querySelector('header .flex.items-center.space-x-2');
        if (headerRight) {
            const githubLink = document.createElement('a');
            githubLink.href = 'https://github.com/Neosowo';
            githubLink.target = '_blank';
            githubLink.rel = 'noopener noreferrer';
            githubLink.innerHTML = '<i class="fab fa-github" style="font-size: 1.5rem; color: white;"></i>';
            githubLink.style.marginLeft = 'auto';
            headerRight.appendChild(githubLink);
        }

        // Añade la clase 'loaded' para activar la animación de la línea
        setTimeout(() => {
            document.querySelector('.sidebar-header').classList.add('loaded');
        }, 100); // pequeño delay para que la animación sea visible
    });
    </script>
    <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
</body>
</html>
